module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(r,s,function(t){return e[t]}.bind(null,s));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist/",n(n.s=6)}([function(e,t){e.exports=require("express")},function(e,t,n){"use strict";var r=n(2),s=n(3);s.Promise=global.Promise;var i={};i.mongoose=s,i.url=r.url,i.beers=n(10)(s),i.breweries=n(11)(s),i.user=n(4)(s),e.exports=i},function(e,t,n){"use strict";console.log({NODENV:"production"}),e.exports={url:"mongodb+srv://root:toor@cluster0-4vfsv.gcp.mongodb.net/primary?retryWrites=true&w=majority",jwtSecret:process.env.JWT_SECRET||"Supercalifragilisticexpialidotious"}},function(e,t){e.exports=require("mongoose")},function(e,t,n){"use strict";n(3);var r=n(12);e.exports=function(e){var t=new e.Schema({name:{type:String,trim:!0,required:"Name is required"},email:{type:String,trim:!0,unique:"Email already exists",match:[/.+\@.+\..+/,"Please fill a valid email address"],required:"Email is required"},hashed_password:{type:String,required:"Password is required"},salt:String,updated:Date,created:{type:Date,default:Date.now}});return t.virtual("password").set((function(e){this._password=e,this.salt=this.makeSalt(),this.hashed_password=this.encryptPassword(e)})).get((function(){return this._password})),t.path("hashed_password").validate((function(e){this._password&&this._password.length<6&&this.invalidate("password","Password must be at least 6 characters."),this.isNew&&!this._password&&this.invalidate("password","Password is required")}),null),t.methods={authenticate:function(e){return this.encryptPassword(e)===this.hashed_password},encryptPassword:function(e){if(!e)return"";try{return r.createHmac("sha1",this.salt).update(e).digest("hex")}catch(e){return""}},makeSalt:function(){return Math.round((new Date).valueOf()*Math.random())+""}},e.model("User",t)}},function(e,t,n){"use strict";var r=n(4),s=n(20),i=n(21),o=n(2);console.log({CONFIG:o}),t.signin=function(e,t){r.findOne({email:e.body.email},(function(n,r){if(n||!r)return t.status("401").json({error:"User Not Found"});if(!r.authenticate(e.body.password))return t.status("401").send({error:"Email and password don't match"});var i=s.sign({_id:r._id},o.jwtSecret);return t.cookie("t",i,{expire:new Date+9999}),t.json({token:i,user:{_id:r._id,name:r.name,email:r.email}})}))},t.signout=function(e,t){return t.clearCookie("t"),t.status("200").json({message:"Signed Out"})},t.requireSignin=i({secret:o.jwtSecret,userProperty:"auth",algorithms:["RS256"]}),t.hasAuthorization=function(e,t,n){if(!(e.profile&&e.auth&&e.profile._id==e.auth_id))return t.status("403").json({error:"User is not Authorized"});n()}},function(e,t,n){e.exports=n(7)},function(e,t,n){"use strict";var r=n(0),s=n(8),i=n(9),o=r();o.use(i({origin:"http://localhost:3000"})),o.use(s.json()),o.use(s.urlencoded({extended:!0}));var a=n(1);a.mongoose.connect(a.url,{useNewUrlParser:!0,useUnifiedTopology:!0}).then((function(){console.log("Connected to the database!")})).catch((function(e){console.log("Cannot connect to the database!",e),process.exit()})),o.get("/",(function(e,t){t.json({message:"Welcome to hops api."})})),n(13)(o),n(15)(o),n(17)(o),n(22)(o);var u=process.env.PORT||8080;o.listen(u,(function(){console.log("Server is running on port "+u+".")}))},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("cors")},function(e,t,n){"use strict";e.exports=function(e){var t=e.Schema({name:String,image:String,description:String,brewery:String,ibu:String,abv:String,rating:Number,isFavorite:Boolean},{timestamps:!0});return t.method("toJSON",(function(){var e=this.toObject(),t=(e.__v,e._id),n=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["__v","_id"]);return n.id=t,n})),e.model("beer",t)}},function(e,t,n){"use strict";e.exports=function(e){var t=e.Schema({name:String,image:String,address:String,phone:String,rating:Number,isFavorite:Boolean},{timestamps:!0});return t.method("toJSON",(function(){var e=this.toObject(),t=(e.__v,e._id),n=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["__v","_id"]);return n.id=t,n})),e.model("brewery",t)}},function(e,t){e.exports=require("crypto")},function(e,t,n){"use strict";e.exports=function(e){var t=n(14),r=n(0).Router();r.post("/",t.create),r.get("/",t.findAll),r.get("/toprated",t.findAllTopRated),r.get("/favorites",t.findFavorites),r.get("/:id",t.findOne),r.put("/:id",t.update),r.delete("/:id",t.delete),r.delete("/",t.deleteAll),e.use("/api/beers",r)}},function(e,t,n){"use strict";var r=n(1).beers;t.create=function(e,t){if(e.body.name){var n=new r({name:e.body.name,image:e.body.image,description:e.body.description,brewery:e.body.brewery,ibu:e.body.ibu,abv:e.body.abv});n.save(n).then((function(e){t.send(e)})).catch((function(e){t.status(500).send({message:e.message||"Some error occurred while creating the Beer."})}))}else t.status(400).send({message:"Content can not be empty!"})},t.findAll=function(e,t){var n=e.query.name,s=n?{name:{$regex:new RegExp(n),$options:"i"}}:{};r.find(s).then((function(e){t.send(e)})).catch((function(e){t.status(500).send({message:e.message||"Some error occurred while retrieving beers."})}))},t.findOne=function(e,t){var n=e.params.id;r.findById(n).then((function(e){e?t.send(e):t.status(404).send({message:"Not found Beer with id "+n})})).catch((function(e){t.status(500).send({message:"Error retrieving Beer with id="+n})}))},t.update=function(e,t){if(!e.body)return t.status(400).send({message:"Data to update can not be empty!"});var n=e.params.id;r.findByIdAndUpdate(n,e.body,{useFindAndModify:!1}).then((function(e){e?t.send({message:"Beer was updated successfully."}):t.status(404).send({message:"Cannot update Beer with id="+n+". Maybe Beer was not found!"})})).catch((function(e){t.status(500).send({message:"Error updating Beer with id="+n})}))},t.delete=function(e,t){var n=e.params.id;r.findByIdAndDelete(n).then((function(e){e?t.send({message:"Beer was deleted successfully!"}):t.status(404).send({message:"Cannot delete Beer with id="+n+". Maybe Beer was not found!"})})).catch((function(e){t.status(500).send({message:"Could not delete Beer with id="+n})}))},t.deleteAll=function(e,t){r.deleteMany({}).then((function(e){t.send({message:e.deletedCount+" Beers were deleted successfully!"})})).catch((function(e){t.status(500).send({message:e.message||"Some error occurred while removing all beers."})}))},t.findAllTopRated=function(e,t){r.find({rating:{$gt:3}}).then((function(e){t.send(e)})).catch((function(e){t.status(500).send({message:e.message||"Some error occurred while retrieving beers."})}))},t.findFavorites=function(e,t){r.find({isFavorite:!0}).then((function(e){t.send(e)})).catch((function(e){t.status(500).send({message:e.message||"Some error occurred while retrieving beers."})}))}},function(e,t,n){"use strict";e.exports=function(e){var t=n(16),r=n(0).Router();r.post("/",t.create),r.get("/",t.findAll),r.get("/toprated",t.findAllTopRated),r.get("/favorites",t.findFavorites),r.get("/:id",t.findOne),r.put("/:id",t.update),r.delete("/:id",t.delete),r.delete("/",t.deleteAll),e.use("/api/breweries",r)}},function(e,t,n){"use strict";var r=n(1).breweries;t.create=function(e,t){if(e.body.name){var n=new r({name:e.body.name,image:e.body.image,address:e.body.address,phone:e.body.phone});n.save(n).then((function(e){t.send(e)})).catch((function(e){t.status(500).send({message:e.message||"Some error occurred while creating the Brewery."})}))}else t.status(400).send({message:"Content can not be empty!"})},t.findAll=function(e,t){var n=e.query.name,s=n?{name:{$regex:new RegExp(n),$options:"i"}}:{};r.find(s).then((function(e){t.send(e)})).catch((function(e){t.status(500).send({message:e.message||"Some error occurred while retrieving breweries."})}))},t.findOne=function(e,t){var n=e.params.id;r.findById(n).then((function(e){e?t.send(e):t.status(404).send({message:"Not found Brewery with id "+n})})).catch((function(e){t.status(500).send({message:"Error retrieving Brewery with id="+n})}))},t.update=function(e,t){if(!e.body)return t.status(400).send({message:"Data to update can not be empty!"});var n=e.params.id;r.findByIdAndUpdate(n,e.body,{useFindAndModify:!1}).then((function(e){e?t.send({message:"Brewery was updated successfully."}):t.status(404).send({message:"Cannot update Brewery with id="+n+". Maybe Brewery was not found!"})})).catch((function(e){t.status(500).send({message:"Error updating Brewery with id="+n})}))},t.delete=function(e,t){var n=e.params.id;r.findByIdAndDelete(n).then((function(e){e?t.send({message:"Brewery was deleted successfully!"}):t.status(404).send({message:"Cannot delete Brewery with id="+n+". Maybe Brewery was not found!"})})).catch((function(e){t.status(500).send({message:"Could not delete Brewery with id="+n})}))},t.deleteAll=function(e,t){r.deleteMany({}).then((function(e){t.send({message:e.deletedCount+" Brewerys were deleted successfully!"})})).catch((function(e){t.status(500).send({message:e.message||"Some error occurred while removing all breweries."})}))},t.findAllTopRated=function(e,t){r.find({rating:{$gt:3}}).then((function(e){t.send(e)})).catch((function(e){t.status(500).send({message:e.message||"Some error occurred while retrieving brewerys."})}))},t.findFavorites=function(e,t){r.find({isFavorite:!0}).then((function(e){t.send(e)})).catch((function(e){t.status(500).send({message:e.message||"Some error occurred while retrieving brewerys."})}))}},function(e,t,n){"use strict";e.exports=function(e){var t=n(18),r=n(5),s=n(0).Router();s.get("/list",t.list),s.post("/create",t.create),s.get("/:userId",r.requireSignin,t.read),s.put("/:userId",r.requireSignin,t.update),s.delete("/:userId",r.requireSignin,t.remove),s.param("userId",t.userById),e.use("/api/users",s)}},function(e,t,n){"use strict";var r=n(1).user,s=n(19);t.create=function(e,t,n){new r(e.body).save((function(e,n){if(e)return console.error("Error: Issue create new user"),t.status(404).json({error:e});t.status(200).json({message:"successfully signed up"})}))},t.list=function(e,t){r.find((function(e,n){if(e)return t.status(400).json({error:e});t.json(n)})).select("name email updated created")},t.userById=function(e,t,n,s){r.findById(s).exec((function(r,s){if(r||!s)return t.status("400").json({error:"User not found"});e.profile=s,n()}))},t.read=function(e,t){return e.profile.hashed_password=void 0,e.profile.salt=void 0,t.json(e.profile)},t.update=function(e,t,n){var r=e.profile;(r=s.extend(r,e.body)).updated=Date.now(),r.save((function(e){if(e)return t.status(400).json({error:e});r.hashed_password=void 0,r.salt=void 0,t.json(r)}))},t.remove=function(e,t,n){e.profile.remove((function(e,n){if(e)return t.status(400).json({error:e})}))}},function(e,t){e.exports=require("lodash")},function(e,t){e.exports=require("jsonwebtoken")},function(e,t){e.exports=require("express-jwt")},function(e,t,n){"use strict";e.exports=function(e){var t=n(5),r=n(0).Router();r.post("/signin",t.signin),r.get("/signout",t.signout),e.use("/auth",r)}}]);